## ðŸ§‘ðŸ»â€ðŸ’»Â useEffect

---

> `useEffect` ëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ ë™ê¸°í™”í•  ìˆ˜ ìžˆëŠ” React í›…ì´ë‹¤.

### âœ…Â useEffect ë¬¸ë²•

```tsx
useEffect(setup, dependencies?)
```

- `setup` ì€ Effectì˜ ë¡œì§ì´ í¬í•¨ëœ í•¨ìˆ˜ì´ë‹¤.

- `dependencies` ëŠ” setup ì½”ë“œ ë‚´ì—ì„œ ì°¸ì¡°ëœ ëª¨ë“  ë°˜ì‘í˜• ê°’ì˜ ëª©ë¡ì´ë‹¤.

- `useEffect`ëŠ” `undefined`ë¥¼ ë°˜í™˜í•œë‹¤.

## ðŸ§‘ðŸ»â€ðŸ’»Â ì•Œê³  ê°€ê¸°

---

### âœ…Â useEffectë¥¼ ì–¸ì œ ì‚¬ìš©í•´ì•¼ í•˜ëŠ”ê°€?

- `setInterval()` ë° `clearInterval()`ë¡œ ê´€ë¦¬ë˜ëŠ” íƒ€ì´ë¨¸ ì‚¬ìš© ì‹œ
- `dialog.showModal()` ë° `dialog.close()` ë¡œ ê´€ë¦¬ë˜ëŠ” dialog ì‚¬ìš© ì‹œ
- `window.addEventListener()` ë° `window.removeEventListener()`ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ë²¤íŠ¸ë¥¼ êµ¬ë…í•  ë•Œ
- `animation.start()` ë° `animation.reset()`ê³¼ ê°™ì€ APIê°€ ìžˆëŠ” íƒ€ì‚¬ ì• ë‹ˆë©”ì´ì…˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•  ë•Œ

### âœ…Â setup í•¨ìˆ˜ì™€ cleanup í•¨ìˆ˜ ë™ìž‘

- ReactëŠ” ì»´í¬ë„ŒíŠ¸ê°€ DOMì— ì¶”ê°€ë˜ë©´ setup í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œë‹¤.

- ReactëŠ” (cleanup í•¨ìˆ˜ê°€ ìžˆëŠ” ê²½ìš°) ë¨¼ì € ì´ì „ ê°’ìœ¼ë¡œ cleanup í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œ ë‹¤ìŒ, ìƒˆ ê°’ìœ¼ë¡œ setup í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œë‹¤.

- ì»´í¬ë„ŒíŠ¸ê°€ DOMì—ì„œ ì œê±°ë˜ë©´, ReactëŠ” ë§ˆì§€ë§‰ìœ¼ë¡œ cleanup í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.

### âœ…Â ì „ë‹¬ëœ dependenciesì— ë”°ë¼ ë‹¤ë¥¸ Effect ë™ìž‘

- dependenciesì— ì˜ì¡´ì„± ë°°ì—´ì„ ì „ë‹¬í•˜ë©´, ì´ˆê¸° ë Œë”ë§ ì´í›„ì™€ ì»´í¬ë„ŒíŠ¸ì˜ propsë‚˜ stateê°€ ë³€ê²½ë  ë•Œ Effectê°€ ì‹¤í–‰ëœë‹¤.

- dependenciesì— ë¹ˆ ë°°ì—´ì„ ì „ë‹¬í•˜ë©´, ì´ˆê¸° ë Œë”ë§ ì´í›„ì—ë§Œ Effectê°€ ì‹¤í–‰ë˜ê³  ì»´í¬ë„ŒíŠ¸ì˜ propsë‚˜ stateê°€ ë³€ê²½ë˜ì–´ë„ Effectê°€ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤.

- dependenciesì— ì˜ì¡´ì„±ì„ ì „í˜€ ì „ë‹¬í•˜ì§€ ì•Šìœ¼ë©´, ì»´í¬ë„ŒíŠ¸ë¥¼ (ë¦¬)ë Œë”ë§í•  ë•Œë§ˆë‹¤ Effectê°€ ë‹¤ì‹œ ì‹¤í–‰ë¤ë‹¤.

- ì°¸ê³ ë¡œ ì˜ì¡´ì„± ë°°ì—´ì— ì „ë‹¬ë˜ëŠ” ë°˜ì‘í˜• ê°’ì—ëŠ” propsì™€ state, ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ ì§ì ‘ ì„ ì–¸ëœ ëª¨ë“  ë³€ìˆ˜, í•¨ìˆ˜ê°€ í¬í•¨ëœë‹¤.

### âœ…Â ì£¼ì˜ ì‚¬í•­

- EffectsëŠ” ì„œë²„ ë Œë”ë§ ì¤‘ì—ëŠ” ì‹¤í–‰ë˜ì§€ ì•Šê³  í´ë¼ì´ì–¸íŠ¸ì—ì„œë§Œ ì‹¤í–‰ëœë‹¤. 

- ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ ë™ê¸°í™”í•˜ë ¤ëŠ” ëª©ì ì´ ì•„ë‹ˆë¼ë©´ Effectê°€ í•„ìš”í•˜ì§€ ì•Šì„ ìˆ˜ë„ ìžˆë‹¤.

- ë Œë”ë§ì„ ìœ„í•´ ë°ì´í„°ë¥¼ ë³€í™˜í•˜ëŠ” ê²½ìš° useEffectëŠ” í•„ìš”í•˜ì§€ ì•Šë‹¤.

- ì˜ì¡´ì„±ì— ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì— ì •ì˜ëœ ê°ì²´ ë˜ëŠ” í•¨ìˆ˜ê°€ ìžˆëŠ” ê²½ìš° ë Œë”ë§ì´ ì§„í–‰ë  ë•Œë§ˆë‹¤ ìƒˆë¡œ ì„ ì–¸ë˜ê¸° ë•Œë¬¸ì—, Effectê°€ í•„ìš” ì´ìƒìœ¼ë¡œ ë‹¤ì‹œ ì‹¤í–‰ë  ìˆ˜ ìžˆë‹¤.

- Effectê°€ ìƒí˜¸ìž‘ìš©(ì˜ˆ: í´ë¦­) ìœ¼ë¡œ ì¸í•œ ê²ƒì´ ì•„ë‹ˆë¼ë©´, ReactëŠ” ë¸Œë¼ìš°ì €ê°€ ì—…ë°ì´íŠ¸ëœ í™”ë©´ì„ ë¨¼ì € ê·¸ë¦¬ê³  Effectë¥¼ ì‹¤í–‰í•˜ë„ë¡ í•œë‹¤.

- ìƒí˜¸ìž‘ìš©ìœ¼ë¡œ ì¸í•´ state ë³€í™”ë¡œ Effectê°€ ë°œìƒí•˜ë”ë¼ë„, ë¸Œë¼ìš°ì €ê°€ í™”ë©´ì„ ë‹¤ì‹œ ì¹ í•˜ì§€ ëª»í•˜ë„ë¡ ì°¨ë‹¨í•  ê²½ìš°ì—ëŠ” `useLayoutEffect` ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

## ðŸ§‘ðŸ»â€ðŸ’»Â í™œìš© ë° ìƒê°í•  ê±°ë¦¬

---

### âœ…Â Effectì—ì„œ ë°ì´í„° fetchingí•˜ëŠ” ê²ƒì€ ì¢‹ì€ ë°©ë²•ì¸ê°€?

- Effect ë‚´ë¶€ì— ë°ì´í„° fetchingì„ í•˜ëŠ” ê²ƒì€ client-side ì•±ì—ì„œ ìžì£¼ ì‚¬ìš©ë˜ì§€ë§Œ ë§¤ìš° ìˆ˜ë™ì ì¸ ì ‘ê·¼ ë°©ì‹ì´ê³  ë§Žì€ ë‹¨ì ì´ ìžˆë‹¤. 

- Effectsì—ì„œ ì§ì ‘ fetchingí•œë‹¤ëŠ” ê²ƒì€ ì¼ë°˜ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ë¡œë“œí•˜ê±°ë‚˜ ìºì‹œí•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì»´í¬ë„ŒíŠ¸ê°€ ë§ˆìš´íŠ¸ë¥¼ í•´ì œí–ˆë‹¤ê°€ ë‹¤ì‹œ ë§ˆìš´íŠ¸í•˜ë©´ ë°ì´í„°ë¥¼ ë‹¤ì‹œ ê°€ì ¸ì™€ì•¼ í•œë‹¤. Effectsì—ì„œ ì§ì ‘ ë°ì´í„°ë¥¼ fetchingí•˜ëŠ” ìž‘ì—…ì„ ë°˜ë³µì ìœ¼ë¡œ ìž‘ì„±í•˜ë©´ ë‚˜ì¤‘ì— ìºì‹± ë° ì„œë²„ ë Œë”ë§ê³¼ ê°™ì€ ìµœì í™”ë¥¼ ì¶”ê°€í•˜ê¸°ê°€ ì–´ë ¤ì›Œì§„ë‹¤.

- [framework](https://react-ko.dev/learn/start-a-new-react-project#production-grade-react-frameworks) (Next.js)ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, í”„ë ˆìž„ì›Œí¬ ë¹ŒíŠ¸ì¸ ë°ì´í„° fetching ë©”ì»¤ë‹ˆì¦˜ì„ ì‚¬ìš©í•˜ìž. ê·¸ê²Œ ì•„ë‹ˆë¼ë©´  [React Query](https://react-query.tanstack.com/), [useSWR](https://swr.vercel.app/), [React Router 6.4+](https://beta.reactrouter.com/en/main/start/overview) ë“±ê³¼ ê°™ì€ client-side ìºì‹œë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê³ ë ¤í•˜ìž.

### âœ…Â ë°ì´í„° Fetching ì‹œ í´ë¦°ì—… í•¨ìˆ˜ë¡œ ê²½ìŸ ì¡°ê±´ì„ í”¼í•˜ìž!

```jsx
function SearchResults({ query }) {
  const [results, setResults] = useState([]);
  const [page, setPage] = useState(1);

  useEffect(() => {
    let ignore = false;

    fetchResults(query, page).then(json => {
      if (!ignore) {
        setResults(json);
      }
    });

    return () => {
      ignore = true;
    };
  }, [query, page]);

  function handleNextPageClick() {
    setPage(page + 1);
  }
  // ...
}
```

- `"hello"`ë¥¼ ë¹ ë¥´ê²Œ ìž…ë ¥í•œë‹¤ê³  í•  ë•Œ, `query`ê°€ `"h"`ì—ì„œ `"he"`, `"hell"`, `"hello"`ë¡œ ì ì°¨ ë³€ê²½ëœë‹¤. ê° ê²½ìš°ì— ëŒ€í•´ íŽ˜ì¹­ì„ ìˆ˜í–‰í•˜ì§€ë§Œ, ì–´ë–¤ ìˆœì„œë¡œ ì‘ë‹µì´ ë„ì°©í• ì§€ëŠ” ë³´ìž¥í•  ìˆ˜ ì—†ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, `"hell"` ì‘ë‹µì€ `"hello"` ì‘ë‹µ ì´í›„ì— ë„ì°©í•  ìˆ˜ ìžˆë‹¤. ì´ì— ë”°ë¼ ë§ˆì§€ë§‰ì— í˜¸ì¶œëœ `setResults()`ë¡œë¶€í„° ìž˜ëª»ëœ ê²€ìƒ‰ ê²°ê³¼ê°€ í‘œì‹œë  ìˆ˜ ìžˆë‹¤.

- ì´ì²˜ëŸ¼ ì„œë¡œ ë‹¤ë¥¸ ë‘ ìš”ì²­ì´ ì„œë¡œ â€˜ê²½ìŸâ€™í•˜ì—¬ ì˜ˆìƒê³¼ ë‹¤ë¥¸ ìˆœì„œë¡œ ë„ì°©í•œ ê²½ìš°ë¥¼ â€˜ê²½ìŸ ì¡°ê±´â€™ì´ë¼ê³  í•œë‹¤.

- ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ì„œ ëª¨ë“  Effectë¥¼ ë…ë¦½ì ì¸ í”„ë¡œì„¸ìŠ¤ë¡œ ìž‘ì„±í•˜ê³  í•œ ë²ˆì— í•˜ë‚˜ì˜ ì…‹ì—…/í´ë¦°ì—… ì£¼ê¸°ë§Œ ìƒê°í•˜ìž. í´ë¦°ì—… ë¡œì§ì´ ì…‹ì—… ë¡œì§ì„ ì˜¬ë°”ë¥´ê²Œ â€˜ë¯¸ëŸ¬ë§â€™í•˜ê³  ìžˆë‹¤ë©´, ì…‹ì—…ê³¼ í´ë¦°ì—…ì„ ìžì£¼ ì‹¤í–‰í•˜ë”ë¼ë„ Effect ë™ìž‘ì— ë¬´ë¦¬ê°€ ì—†ë‹¤.

### âœ…Â ìµœìƒìœ„ ë³€ìˆ˜ë¡œ ì•± ë¡œë“œ ë‹¹ í•œ ë²ˆë§Œ Effect ì‹¤í–‰í•˜ëŠ” ë°©ë²•ì€?

```jsx
let didInit = false;

function App() {
  useEffect(() => {
    if (!didInit) {
      didInit = true;

	    // âœ… ì•± ë¡œë“œë‹¹ í•œ ë²ˆë§Œ ì‹¤í–‰ë¨
      loadDataFromLocalStorage();
      checkAuthToken();
    }
  }, []);
  // ...
}
```

- ì¼ë¶€ ë¡œì§ì´ ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸ ë‹¹ í•œë²ˆì´ ì•„ë‹ˆë¼ ì•± ë¡œë“œë‹¹ í•œë²ˆ ì‹¤í–‰ë˜ì•¼ í•˜ëŠ” ê²½ìš°, ìµœìƒìœ„ ë³€ìˆ˜ë¥¼ ì¶”ê°€í•˜ì—¬ ì´ë¯¸ ì‹¤í–‰ë˜ì—ˆëŠ” ì§€ ì—¬ë¶€ë¥¼ ì¶”ì í•´ì•¼ í•œë‹¤.

### âœ…Â Effectì˜ ì´ì „ stateë¥¼ ê¸°ë°˜ìœ¼ë¡œ state ì—…ë°ì´íŠ¸ í•˜ë ¤ë©´?

```tsx
function Counter() {
  const [count, setCount] = useState(0);

  useEffect(() => {
    const intervalId = setInterval(() => {
      setCount(count + 1); // ë§¤ ì´ˆë§ˆë‹¤ count ì—…ë°ì´íŠ¸
    }, 1000)

    return () => clearInterval(intervalId);
  }, [count]);
  // ...
}
```

- `count`ëŠ” ë°˜ì‘í˜• ê°’ì´ë¯€ë¡œ ì˜ì¡´ì„± ëª©ë¡ì— ì§€ì •ë˜ì–´ì•¼ í•œë‹¤. ë‹¤ë§Œ ì´ë¡œ ì¸í•´ stateê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ ë¬´í•œë°˜ë³µìœ¼ë¡œ Effectë¥¼ ë‹¤ì‹œ í´ë¦°ì—…í•˜ê³  ì…‹ì—… í•˜ê²Œ ëœë‹¤.

- ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ë©´ `setCount`ì— `c => c + 1` ì²˜ëŸ¼ state ì—…ë°ì´í„° í•¨ìˆ˜ë¥¼ ì „ë‹¬í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

### âœ…Â ê° ì´ë²¤íŠ¸ ë³„ ë¡œì§ì˜ ê²½ìš° Effect ë‚´ë¶€ì— í•œ ë²ˆì— ì‚¬ìš©í•˜ì§€ ë§ìž.

- â€˜ë²„íŠ¼ í´ë¦­â€™ í˜¹ì€ â€˜ë¬´ì–¸ê°€ ì™„ë£Œ ì‹œ alert ì°½ ì˜¤í”ˆâ€™ê³¼ ê°™ì´ ìƒíƒœë¥¼ ê³„ì† ì¶”ì í•´ì•¼ í•˜ëŠ” ì‚¬ìš©ìž ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•´ì•¼ í•  ê²½ìš°ê°€ ìžˆë‹¤. ì´ëŸ´ ê²½ìš° Effectë¥¼ ì‚¬ìš©í•˜ì—¬ ë™ìž‘ì„ í•œ ë²ˆì— ê´€ë¦¬í•˜ëŠ” ê²ƒ ë³´ë‹¤, ì´ë²¤íŠ¸ë¥¼ handler í•¨ìˆ˜ì—ì„œ ë”°ë¡œ ë”°ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤. useEffectë¥¼ ì‚¬ìš©í•˜ë©´ ê°’ì˜ ìƒíƒœë¥¼ ì•Œ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì—, ì‚¬ìš©ìžê°€ ì–´ë–¤ ë™ìž‘ì„ í–ˆëŠ” ì§€ ì•Œ ìˆ˜ ì—†ë‹¤.

```tsx
// Bad

function ProductPage({ product, addToCart }) {
  useEffect(() => {
    if (product.isInCart) {
      showNotification(`Added ${product.name} to the shopping cart!`);
    }
  }, [product]);

  function handleBuyClick() {
    addToCart(product);
  }

  function handleCheckoutClick() {
    addToCart(product);
    navigateTo('/checkout');
  }
  // ...
}
```

```tsx
// Good

function ProductPage({ product, addToCart }) {
  function buyProduct() {
    addToCart(product);
    showNotification(`Added ${product.name} to the shopping cart!`);
  }

  function handleBuyClick() {
    buyProduct();
  }

  function handleCheckoutClick() {
    buyProduct();
    navigateTo('/checkout');
  }
  // ...
}
```